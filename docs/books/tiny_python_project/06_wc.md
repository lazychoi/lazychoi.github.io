---
title: 06장 단어 세기 프로그램 만들기
date: 2022-10-18
---

## 배운 것

argparse: 하나 이상의 핸들로 구성된 리스트 반환

- 여러 개 인자를 받는 옵션이 3가지다. `nargs=`'?'(0 또는 1개), '*'(0개 이상), '+'(1개 이상) 
- 파일을 인자로 받을 때 유효성 검증: `type=argparse.FileType('rt')`
- 인수의 기본값을 표준 입력이 포함된 리스트로 설정: `default=[sys.stdin]`

arg.file: 파일 열기 핸들로 구성된 리스트

- 인자로 입력한 파일 개수 출력: `len(args.file)`
- 파일 인자를 변수에 받으면(파일 핸들, `for fh in args.file`) `fh.name`에 경로와 파일명이 저장된다.
- 텍스트 파일 줄 개수 -> `for line in fh`(파일 핸들 내의 각 줄을 읽어나간다) -> 반복할 때마다 count 증가
- 한 줄의 바이트 수 -> `len(line)`
- 한 줄의 단어 개수 -> 공백으로 분리(문장부호 없다고 가정) -> 리스트 반환 -> `len(line.split())`
- 스트링 포맷(str.format()): 각 항목 너비 설정 -> `{항목:숫자}` 항목이 숫자이면 오른쪽, 문자면 왼쪽 정렬

## 코드

```python
#!/usr/bin/env python3
"""
Author : playdata <playdata@localhost>
Date   : 2022-10-18
Purpose: Emulate (word count)
"""

import sys
import argparse


# --------------------------------------------------
def get_args():
    """Get command-line arguments"""

    parser = argparse.ArgumentParser(
        description='Emulate (word count)',
        formatter_class=argparse.ArgumentDefaultsHelpFormatter)

    parser.add_argument('file',
                        metavar='FILE',
                        nargs="*",   # 0개 이상의 인수를 받는다. '?'= 0 or 1개, '+'=1개 이상
                        type=argparse.FileType('rt'), # argparse가 유효한 파일인지 검증한다. 문제 있으면 argparse가 프로그램을 멈추고 오류 메시지를 출력한다.
                        help='Input file(s)', 
                        default=[sys.stdin]) # 기본값으로 sys.stdin이 포함된 리스트를 설정하면 STDIN(표준입력)을 사용할 수 있다.

    return parser.parse_args()


# --------------------------------------------------
def main():
    """Make a jazz noise here"""

    args = get_args()
    

    total_lines, total_words, total_bytes = 0, 0, 0
    for fh in args.file:   # fh라는 변수를 사용해서 STDIN과 파일 핸들을 사용한다는 사실을 상기시킨다.
        num_lines, num_words, num_bytes = 0, 0, 0
        for line in fh:   # 파일 핸들을 한 줄씩 읽는다.
            num_lines += 1
            num_words += len(line.split()) # 공백을 기준으로 텍스트를 분리해 리스트로 저장 -> 리스트 크기 = 단어 개수. 문장 부호가 포함된 경우에는 오류 발생 -> 정규표현식 필요
            num_bytes += len(line)         # 라인별 바이트 수를 더한다
        total_lines += num_lines
        total_words += num_words
        total_bytes += num_bytes    
        
        print(f'{num_lines:8}{num_words:8}{num_bytes:8} {fh.name:8}') # {:8} 각 항목 너비가 8글자. 숫자는 오른쪽, 문자는 왼쪽 정렬된다.

    if len(args.file) > 1:
        print(f'{total_lines:8}{total_words:8}{total_bytes:8} total')

# --------------------------------------------------
if __name__ == '__main__':
    main()
```
